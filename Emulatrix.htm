<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Emulatrix</title>
		<link rel="stylesheet" href="Emulatrix.css">
	</head>
	<body>
		<script>
			function getBooleanSetting(settingName){try{var name = "emulatrix" + settingName;var nameEQ = name + "=";var ca = document.cookie.split(";");for(var i=0;i < ca.length;i++){var c = ca[i];while (c.charAt(0)==" "){c = c.substring(1,c.length);}if (c.indexOf(nameEQ) == 0){if (c.substring(nameEQ.length,c.length)=="true"){return true;}else{return false;}}}}catch(err){}return true;}
			function setBooleanSetting(settingName,settingValue){try{var name = "emulatrix" + settingName;var value = String(settingValue);var days = 999;var expires = "";if (days){var date = new Date();date.setTime(date.getTime() + (days*24*60*60*1000));expires = "; expires=" + date.toUTCString() + "; SameSite=Lax";}document.cookie = name + "=" + (value || "")  + expires + "; Secure; path=/";}catch(err){}}
			function usingiOS(){return !!navigator.platform && /iPad|iPhone|iPod/.test(navigator.platform)}
			function usingSafari(){return navigator.userAgent.toLowerCase().indexOf("safari")>-1 && navigator.userAgent.toLowerCase().indexOf("chrome")==-1}

			var GAME_SOUND_ENABLED = getBooleanSetting("GAME_SOUND_ENABLED");
			var ROMDATA = "";

			function runEmulator()
				{
				try
					{
						// CLEARING THE CONTAINER FROM ANY GAME IN PROGRESS
						document.getElementById("container").contentDocument.location.replace("about:blank");

						var xhttp = new XMLHttpRequest();
  						xhttp.open("GET", "bios.bin");
						xhttp.overrideMimeType("application/octet-stream");
						xhttp.responseType = "arraybuffer";
  						xhttp.onload = function(ev)
							{
							// SETTING THE FILE CONTENT FOR THE EMULATORS
							ROMDATA = xhttp.response;

							// DISPLAYING THE EMULATOR CONTAINER
							document.getElementById("container").style.display = "block";
							document.getElementById("container").focus();

							// HIDING THE PLEASE WAIT ANIMATION
							document.getElementsByClassName("gui_pleasewait")[0].style.display = "none";

							// CHECKING THE ROM EXTENSION AND STARTING THE REQUIRED EMULATOR FOR THE SELECTED ROM
							document.getElementById("container").contentDocument.location.replace("Emulatrix_SegaGenesis.htm");
							};

						xhttp.send();
					}
					catch(err)
					{
					}
				}

			window.addEventListener("load", function()
				{
				// UPDATING THE IFRAME SOURCE WITH A BLANK PAGE
				document.getElementById("container").contentDocument.location.replace("about:blank");

				// CREATING A 250 MS INTERVAL
				setInterval(function()
					{
					// FOCUSING THE CONTAINER
					document.getElementById("container").focus();
					}, 250);

				// CHECKING IF IT IS A MOBILE DEVICE
				if (usingiOS()==true || usingSafari()==true)
					{
					// CHECKING IF THE USER IS USING IOS. EMULATRIX IS NOT COMPATIBLE WITH IOS.
					document.getElementsByClassName("gui_safari")[0].style.display = "block";
					}
					else
					{
					runEmulator();
					}
				});
		</script>

		<iframe id="container" src="about:blank"></iframe>
		<div class="gui_pleasewait"><div class="gui_pleasewait_title">Reading file...</div><div class="pleasewait"><div class="lds-spinner"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div></div>

		<div class="gui_container">
			<div class="gui_safari"><span class="gui_safari_label">Emulatrix<br>is not compatible<br>with the Safari Web browser.</span></div>
		</div>
	</body>
</html>